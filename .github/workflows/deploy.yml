name: Deploy Simple Static Site (Direct Copy)

on:
  push:
    branches:
      - main

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      # 1. Descargar el cÃ³digo de tu repositorio
      - name: Checkout repository
        uses: actions/checkout@v3

      # 2. (DepuraciÃ³n) Listar los archivos que se van a copiar
      - name: ðŸ§ª List repository files
        run: |
          echo "Files in the repository to be deployed:"
          ls -laR

      # 3. Desplegar los archivos al servidor
      - name: ðŸš€ Deploy files to server
        uses: appleboy/ssh-action@master
        with:
          host: ${{ secrets.SSH_HOST }}
          username: ${{ secrets.SSH_USER }}
          key: ${{ secrets.SSH_PRIVATE_KEY }}
          script: |
            # Sincroniza el contenido del directorio actual (./) con el directorio remoto
            # --exclude '.git*' es VITAL para no copiar todo el historial de git
            # --exclude '.github' es para no copiar los workflows
            rsync -avz --delete --exclude '.git*' --exclude '.github' ./ ${{ secrets.REMOTE_PATH }}

            echo "--- Deployment finished ---"
            echo "Final check: Listing contents of remote directory:"
            ls -laR ${{ secrets.REMOTE_PATH }}
